{"ast":null,"code":"import { util } from './../plugins/util.js';\nimport { feeAjax } from './feeAjax.js';\nimport $ from 'jquery';\nfunction makeCacheHeader(headers, url, data, options) {\n  headers['Symper-Request-Name'] = options.requestName ? options.requestName : util.str.hashCode(JSON.stringify(['GET', url, data]));\n  headers['Symper-Cache-Strategy'] = options.cacheStrategy ? 'cache-first' : 'network-first';\n  return headers;\n}\nexport default class Api {\n  /**\r\n   * Khởi tạo một class Api với base url\r\n   * @param {String} baseUrl\r\n   */\n  constructor(baseUrl) {\n    this.baseUrl = baseUrl[baseUrl.length - 1] == '/' ? baseUrl : baseUrl + '/';\n  }\n\n  /**\r\n   * Tạo url từ uri\r\n   * @param {String} uri uri\r\n   */\n  getFullUrl(uri) {\n    uri = uri.trim();\n    return this.baseUrl + uri;\n  }\n\n  /**\r\n   * Thực hiện post request\r\n   * @param {String} uri uri của API\r\n   * @param {Object} data data muốn gửi về cho server\r\n   * @param {Object} header custom header cho request\r\n   * @param {Object} options các option thêm cho request theo Jquery Ajax\r\n   * @returns {Object} Đối tượng có thể sử dụng như của promise\r\n   */\n  post(uri, data, header = {}, options = {}) {\n    let url = this.getFullUrl(uri);\n    return this.callApi('POST', url, data, header, options);\n  }\n\n  /**\r\n   * Thực hiện get request\r\n   * @param {String} uri uri của API\r\n   * @param {Object} data data muốn gửi về cho server\r\n   * @param {Object} header custom header cho request\r\n   * @param {Object} options các option thêm cho request theo Jquery Ajax\r\n   * @returns {Object} Đối tượng có thể sử dụng như của promise\r\n   */\n  get(uri, data = {}, header = {}, options = {}) {\n    let url = this.getFullUrl(uri);\n    return this.callApi('GET', url, data, header, options);\n  }\n\n  /**\r\n   * Thực hiện put request\r\n   * @param {String} uri uri của API\r\n   * @param {Object} data data muốn gửi về cho server\r\n   * @param {Object} header custom header cho request\r\n   * @param {Object} options các option thêm cho request theo Jquery Ajax\r\n   * @returns {Object} Đối tượng có thể sử dụng như của promise\r\n   */\n  put(uri, data, header = {}, options = {}) {\n    let url = this.getFullUrl(uri);\n    return this.callApi('PUT', url, data, header, options);\n  }\n  /**\r\n   * Thực hiện patch request\r\n   * @param {String} uri uri của API\r\n   * @param {Object} data data muốn gửi về cho server\r\n   * @param {Object} header custom header cho request\r\n   * @param {Object} options các option thêm cho request theo Jquery Ajax\r\n   * @returns {Object} Đối tượng có thể sử dụng như của promise\r\n   */\n  patch(uri, data, header = {}, options = {}) {\n    let url = this.getFullUrl(uri);\n    return this.callApi('PATCH', url, data, header, options);\n  }\n\n  /**\r\n   * Thực hiện delete request\r\n   * @param {String} uri uri của API\r\n   * @param {Object} data data muốn gửi về cho server\r\n   * @param {Object} header custom header cho request\r\n   * @param {Object} options các option thêm cho request theo Jquery Ajax\r\n   * @returns {Object} Đối tượng có thể sử dụng như của promise\r\n   */\n  delete(uri, data, header = {}, options = {}) {\n    let url = this.getFullUrl(uri);\n    return this.callApi('DELETE', url, data, header, options);\n  }\n\n  /**\r\n   * Thực hiện gọi một request tới server\r\n   * @param {String} method Phương thức áp dụng cho request này\r\n   * @param {String} url url cần gọi của API\r\n   * @param {Object} data data muốn gửi về cho server\r\n   * @param {Object} headers custom header cho request\r\n   * @param {Object} options các option thêm cho request theo Jquery Ajax\r\n   * @returns {Object} Đối tượng có thể sử dụng như của promise\r\n   */\n  async callApi(method, url, data, headers, options) {\n    let token = util.auth.getToken();\n    if (token instanceof Promise) {\n      token = await token;\n    }\n    headers = Object.assign({\n      Authorization: `Bearer ${token}`\n    }, headers);\n    if (method == 'GET' || method == 'POST' && options.cacheResponse) {\n      headers = makeCacheHeader(headers, url, data, options);\n    }\n    let defaultOptions = {\n      method: method,\n      data: data,\n      url: url,\n      dataType: 'json',\n      crossDomain: true,\n      headers: headers\n    };\n    options = Object.assign(defaultOptions, options);\n    let res = {};\n    /**\r\n     * Hàm check nếu gọi api từ worker thì thêm 1 hàm mới gọi từ đó\r\n     */\n    if (self.window) {\n      res = await $.ajax(options);\n    } else {\n      res = await feeAjax(options);\n    }\n    return res;\n  }\n}","map":{"version":3,"names":["util","feeAjax","$","makeCacheHeader","headers","url","data","options","requestName","str","hashCode","JSON","stringify","cacheStrategy","Api","constructor","baseUrl","length","getFullUrl","uri","trim","post","header","callApi","get","put","patch","delete","method","token","auth","getToken","Promise","Object","assign","Authorization","cacheResponse","defaultOptions","dataType","crossDomain","res","self","window","ajax"],"sources":["C:/Users/admin/Desktop/nckh k14-k16/frontend/src/api/api.js"],"sourcesContent":["import { util } from './../plugins/util.js';\r\n\r\nimport { feeAjax } from './feeAjax.js';\r\nimport $ from 'jquery'\r\n\r\nfunction makeCacheHeader(headers, url, data, options) {\r\n    headers['Symper-Request-Name'] = options.requestName\r\n        ? options.requestName\r\n        : util.str.hashCode(JSON.stringify(['GET', url, data]));\r\n    headers['Symper-Cache-Strategy'] = options.cacheStrategy\r\n        ? 'cache-first'\r\n        : 'network-first';\r\n    return headers;\r\n}\r\n\r\nexport default class Api {\r\n    /**\r\n     * Khởi tạo một class Api với base url\r\n     * @param {String} baseUrl\r\n     */\r\n    constructor(baseUrl) {\r\n        this.baseUrl =\r\n            baseUrl[baseUrl.length - 1] == '/' ? baseUrl : baseUrl + '/';\r\n    }\r\n\r\n    /**\r\n     * Tạo url từ uri\r\n     * @param {String} uri uri\r\n     */\r\n    getFullUrl(uri) {\r\n        uri = uri.trim();\r\n        return this.baseUrl + uri\r\n    }\r\n\r\n    /**\r\n     * Thực hiện post request\r\n     * @param {String} uri uri của API\r\n     * @param {Object} data data muốn gửi về cho server\r\n     * @param {Object} header custom header cho request\r\n     * @param {Object} options các option thêm cho request theo Jquery Ajax\r\n     * @returns {Object} Đối tượng có thể sử dụng như của promise\r\n     */\r\n    post(uri, data, header = {}, options = {}) {\r\n        let url = this.getFullUrl(uri);\r\n        return this.callApi('POST', url, data, header, options);\r\n    }\r\n\r\n    /**\r\n     * Thực hiện get request\r\n     * @param {String} uri uri của API\r\n     * @param {Object} data data muốn gửi về cho server\r\n     * @param {Object} header custom header cho request\r\n     * @param {Object} options các option thêm cho request theo Jquery Ajax\r\n     * @returns {Object} Đối tượng có thể sử dụng như của promise\r\n     */\r\n    get(uri, data = {}, header = {}, options = {}) {\r\n        let url = this.getFullUrl(uri);\r\n        return this.callApi('GET', url, data, header, options);\r\n    }\r\n\r\n    /**\r\n     * Thực hiện put request\r\n     * @param {String} uri uri của API\r\n     * @param {Object} data data muốn gửi về cho server\r\n     * @param {Object} header custom header cho request\r\n     * @param {Object} options các option thêm cho request theo Jquery Ajax\r\n     * @returns {Object} Đối tượng có thể sử dụng như của promise\r\n     */\r\n    put(uri, data, header = {}, options = {}) {\r\n        let url = this.getFullUrl(uri);\r\n        return this.callApi('PUT', url, data, header, options);\r\n    }\r\n    /**\r\n     * Thực hiện patch request\r\n     * @param {String} uri uri của API\r\n     * @param {Object} data data muốn gửi về cho server\r\n     * @param {Object} header custom header cho request\r\n     * @param {Object} options các option thêm cho request theo Jquery Ajax\r\n     * @returns {Object} Đối tượng có thể sử dụng như của promise\r\n     */\r\n    patch(uri, data, header = {}, options = {}) {\r\n        let url = this.getFullUrl(uri);\r\n        return this.callApi('PATCH', url, data, header, options);\r\n    }\r\n\r\n    /**\r\n     * Thực hiện delete request\r\n     * @param {String} uri uri của API\r\n     * @param {Object} data data muốn gửi về cho server\r\n     * @param {Object} header custom header cho request\r\n     * @param {Object} options các option thêm cho request theo Jquery Ajax\r\n     * @returns {Object} Đối tượng có thể sử dụng như của promise\r\n     */\r\n    delete(uri, data, header = {}, options = {}) {\r\n        let url = this.getFullUrl(uri);\r\n        return this.callApi('DELETE', url, data, header, options);\r\n    }\r\n\r\n    /**\r\n     * Thực hiện gọi một request tới server\r\n     * @param {String} method Phương thức áp dụng cho request này\r\n     * @param {String} url url cần gọi của API\r\n     * @param {Object} data data muốn gửi về cho server\r\n     * @param {Object} headers custom header cho request\r\n     * @param {Object} options các option thêm cho request theo Jquery Ajax\r\n     * @returns {Object} Đối tượng có thể sử dụng như của promise\r\n     */\r\n    async callApi(method, url, data, headers, options) {\r\n        let token = util.auth.getToken();\r\n        if (token instanceof Promise) {\r\n            token = await token;\r\n        }\r\n        headers = Object.assign(\r\n            {\r\n                Authorization: `Bearer ${token}`,\r\n            },\r\n            headers,\r\n        );\r\n\r\n        if (\r\n            method == 'GET' || method == 'POST' && options.cacheResponse\r\n        ) {\r\n            headers = makeCacheHeader(headers, url, data, options);\r\n        }\r\n\r\n        let defaultOptions = {\r\n            method: method,\r\n            data: data,\r\n            url: url,\r\n            dataType: 'json',\r\n            crossDomain: true,\r\n            headers: headers,\r\n        };\r\n        options = Object.assign(defaultOptions, options);\r\n        let res = {};\r\n        /**\r\n         * Hàm check nếu gọi api từ worker thì thêm 1 hàm mới gọi từ đó\r\n         */\r\n        if (self.window) {\r\n            res = await $.ajax(options);\r\n        } else {\r\n            res = await feeAjax(options);\r\n        }\r\n        return res;\r\n    }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}